<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SDR Preference Pathway Assistant</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="app">
      <header class="app__header">
        <h1>SDR Preference Pathway Assistant</h1>
        <p>
          This prototype demonstrates the consent → education → preference capture
          journey described in the SDR specification. Sessions are now saved to a
          durable store so you can refresh the page without losing progress.
        </p>
      </header>

      <section class="status" aria-live="polite">
        <span class="status__item">
          <span class="status__label">Stage</span>
          <span id="stage" class="status__value">Loading…</span>
        </span>
        <span class="status__item">
          <span class="status__label">Session</span>
          <span id="session-id" class="status__value">—</span>
        </span>
      </section>

      <button
        type="button"
        id="view-education-pack"
        class="education-pack-toggle"
        aria-controls="education-pack"
        aria-expanded="false"
        hidden
      >
        View ESG education pack
      </button>


      <section class="interaction" aria-live="polite" aria-label="Assistant prompt">
        <div class="interaction__prompt">
          <h2>Assistant question</h2>
          <p id="current-prompt" class="interaction__prompt-text">
            Loading the first prompt…
          </p>
        </div>
        <form id="composer" class="composer" autocomplete="off">
          <label class="composer__label" for="message-input">Your response</label>
          <textarea
            id="message-input"
            name="message"
            required
            placeholder="Share your reply"
            rows="3"
          ></textarea>
          <button type="submit" id="send-button">Send</button>
          <p id="error" role="alert" class="composer__error" hidden></p>
        </form>
      </section>

      <section class="chat" aria-label="Conversation transcript">
        <h2 class="chat__title">Conversation transcript</h2>
        <ul id="messages" class="chat__messages"></ul>
      </section>

      <section
        class="structured"
        aria-live="polite"
        id="structured-inputs"
      >
        <h2>Structured questionnaire</h2>
        <p>
          Prefer working with forms? Complete the structured questionnaire for
          each stage and I’ll apply your answers automatically.
        </p>
        <div id="stage-form"></div>
      </section>

      <section class="summary" aria-live="polite">
        <h2>Captured data (draft)</h2>
        <pre id="session-data">{}</pre>
      </section>

      <section class="report" id="report-section" hidden aria-live="polite">
        <h2>Report preview</h2>
        <p>
          The assistant generates a summary report once you approve the draft.
          Review the on-screen copy and download the PDF for your records.
        </p>
        <pre id="report-preview"></pre>
        <a id="report-download" href="#" download="preference-pathway.pdf">
          Download PDF report
        </a>
      </section>

      <section
        id="education-pack"
        class="education-pack"
        role="dialog"
        aria-modal="true"
        aria-labelledby="education-pack-title"
        tabindex="-1"
        hidden
      >
        <div class="education-pack__header">
          <h2 id="education-pack-title">ESG education pack</h2>
          <button type="button" id="close-education-pack" class="education-pack__close">
            Return to questionnaire
          </button>
        </div>
        <div class="education-pack__intro">
          <p>
            This pack summarises the key sustainability disclosures required by the
            FCA’s Sustainability Disclosure Requirements (SDR) and Consumer Duty.
            Review the highlights below and let us know when you’re ready to
            continue.
          </p>
        </div>
        <div class="education-pack__content">
          <section>
            <h3>1. ESG essentials</h3>
            <ul>
              <li>ESG stands for Environmental, Social and Governance factors.</li>
              <li>
                These factors highlight sustainability characteristics but do not
                guarantee positive outcomes or investment performance.
              </li>
              <li>
                We assess ESG data alongside financial suitability to make
                balanced recommendations.
              </li>
            </ul>
          </section>
          <section>
            <h3>2. FCA SDR labels</h3>
            <p>The four labels help you understand a fund’s sustainability focus:</p>
            <ul>
              <li><strong>Focus</strong>: invests mainly in companies already leading on sustainability.</li>
              <li><strong>Improvers</strong>: supports companies working to raise their sustainability performance.</li>
              <li><strong>Impact</strong>: targets investments delivering measurable real-world outcomes.</li>
              <li><strong>Mixed Goals</strong>: blends sustainability aims with traditional financial goals.</li>
            </ul>
          </section>
          <section>
            <h3>3. Anti-Greenwashing safeguards</h3>
            <ul>
              <li>
                We only describe a product as sustainable when evidence supports the
                claim.
              </li>
              <li>
                Disclosures and fact sheets are provided with every recommendation
                for you to review.
              </li>
              <li>
                You can request more detail or supporting documents at any time.
              </li>
            </ul>
          </section>
          <section>
            <h3>4. Risks, trade-offs, and governance</h3>
            <ul>
              <li>
                Sustainable investments can still rise or fall in value and may
                underperform broader markets over certain periods.
              </li>
              <li>
                Product governance rules require us to match you with suitable
                solutions based on your goals, timeline, and risk appetite.
              </li>
              <li>
                Stewardship expectations guide how managers engage with companies
                to drive improvements.
              </li>
            </ul>
          </section>
          <section>
            <h3>5. Switching considerations</h3>
            <ul>
              <li>
                Moving from an existing product could trigger costs, exit charges,
                or capital gains.
              </li>
              <li>
                We factor these impacts into suitability assessments before
                recommending any changes.
              </li>
              <li>
                Let us know if you have any restrictions or timelines we should
                consider before switching.
              </li>
            </ul>
          </section>
        </div>
        <footer class="education-pack__footer">
          <p>
            Need the full explainer or disclosures? Ask the assistant and we’ll
            attach the detailed PDF pack for download.
          </p>
          <button type="button" class="education-pack__close" id="return-to-questionnaire">
            Close and continue
          </button>
        </footer>
      </section>
    </main>

    <script type="module" src="./app.js"></script>
  </body>
</html>
